box: combient/java-mvn
build:
  steps:
    - script:
      name: setup maven local repo
      code: |
        export MAVEN_OPTS="-Dmaven.repo.local=${WERCKER_CACHE_DIR}"
        mvn -version
        echo "------"
        du -hs ${WERCKER_CACHE_DIR}
        echo "------"
        du -hs ${WERCKER_CACHE_DIR}/* | sort -h  
    # Build Spring Boot application
    - script:
        name: Maven install
        code: mvn package -Dmaven.test.skip
        
push:
  steps:
    - internal/docker-push:
        cmd: java -jar  ./target/spring-boot-web-1.0.jar
        tag: latest
        ports: "8080"
        username: $DOCKER_USERNAME
        password: $DOCKER_PASSWORD
        repository: $DOCKER_REPO
        registry: https://ap-seoul-1.ocir.io/v2
